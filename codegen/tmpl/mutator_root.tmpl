func write{{.MethodSuffix}}(x *{{.OwnerType}}, vals {{.ParquetType}}, defs, reps []uint8) (int, int) {
	var nVals, nLevels int
	ind := make(indices, {{.Depth}})
	for i := range defs {
		def := defs[i]
		rep := reps[i]
		if i > 0 && rep == 0 {
			break
		}

		nLevels++
		ind.rep(rep)
		switch def {
{{.DefCases}}
		}
	}

	return nVals, nLevels
}